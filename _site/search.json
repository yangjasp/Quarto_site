[
  {
    "objectID": "blog.html",
    "href": "blog.html",
    "title": "Jasper Yang",
    "section": "",
    "text": "Post With Code\n\n\n\n\n\n\n\nnews\n\n\ncode\n\n\nanalysis\n\n\n\n\n\n\n\n\n\n\n\nJun 7, 2023\n\n\nHarlow Malloc\n\n\n\n\n\n\n  \n\n\n\n\nWelcome To My Blog\n\n\n\n\n\n\n\nnews\n\n\n\n\n\n\n\n\n\n\n\nJun 4, 2023\n\n\nTristan O’Malley\n\n\n\n\n\n\n  \n\n\n\n\nModeling COVID-19 and Vaccine Rollout Strategies\n\n\n\n\n\n\n\n\n\n\n\n\nDec 28, 2020\n\n\nJasper Yang\n\n\n\n\n\n\n  \n\n\n\n\nModeling COVID-19 and Vaccine Rollout Strategies\n\n\n\n\n\n\n\n\n\n\n\n\nDec 28, 2020\n\n\nJasper Yang\n\n\n\n\n\n\n  \n\n\n\n\nCOVID-19 Testing and Bayes’ Theorem\n\n\n\n\n\nCOVID tests as new evidence\n\n\n\n\n\n\nDec 15, 2020\n\n\nJasper Yang\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/post-with-code/index.html",
    "href": "posts/post-with-code/index.html",
    "title": "Post With Code",
    "section": "",
    "text": "This is a post with executable code.\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "posts/welcome/index.html",
    "href": "posts/welcome/index.html",
    "title": "Welcome To My Blog",
    "section": "",
    "text": "This is the first post in a Quarto blog. Welcome!\n\nSince this post doesn’t specify an explicit image, the first image in the post will be used in the listing page of posts."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html",
    "href": "posts/vaccine_modelling/VaccineModelling.html",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "",
    "text": "Over the past three weeks, the United States government has approved two different COVID-19 vaccines for emergency use. These two vaccines, one developed by Pfizer and the other by Moderna, are actually quite similar in that they are both two-dose mRNA vaccines with mild side-effects, and they have almost identical efficacy rates (95% and 94.1% respectively according to the FDA). The only notable difference is that the Moderna vaccine can be stored in a standard freezer while the Pfizer vaccine must be stored at -70 degrees Celsius, making it slightly less accessible for small healthcare centers.\nConsequently, U.S. vaccine rollout plans have so far treated the two vaccines as essentially being the same, that is to say neither of the two vaccines is considered better than the other. This somewhat unexpected fact has simplified the already controversial rollout, but the impending introductions of new vaccines from companies like Johnson & Johnson and AstraZaneca threaten to introduce a new complexity. If a new vaccine with only 70% efficacy becomes available, how should it be incorporated into the rollout? Is it better to give at-risk patients a worse vaccine if it means they can get vaccinated a month earlier? Will people even want it?\nThe answers to these questions are certainly complex, and they will likely draw from principles in biology, mathematics, statistics, and economics among other fields. I cannot pretend to be an expert here - I am hopeful that the true experts have been thinking deeply about this issue - but I think the problem is quite fascinating. This post contains my thoughts and some basic modeling!"
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#what-is-vaccine-efficacy",
    "href": "posts/vaccine_modelling/VaccineModelling.html#what-is-vaccine-efficacy",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "What is Vaccine Efficacy?",
    "text": "What is Vaccine Efficacy?\nBefore moving any further, let’s make sure we understand what vaccine efficacy is. Essentially, it is a measure of how well a vaccine prevents cases of the disease in a group of vaccinated subjects compared to a control group of un-vaccinated (received placebo) subjects. An estimate of the efficacy is generated from clinical trial data, which every vaccine must collect and submit to the FDA for review before being made available to the public.\nThe actual calculation of efficacy relies on a term called risk. In epidemiology, risk is the probability that an event (such as infection) will occur in a given time period, and it is measured in a clinical trial as the proportion of total subjects in a group who experienced the event in the time period that they were followed. For example, if 8 out of 1,000 patients who receive an actual vaccine in a clinical trial become infected with COVID-19, then the estimate of risk of infection in the vaccination group is simply 0.008, or 0.8%. The ratio of risk in the treatment (actual vaccine) group compared to the risk in the control (placebo) group is called the risk ratio. Risk ratios below 1 suggest that the treatment reduces the risk of disease compared to the control, and smaller ratios suggest a stronger reduction. Efficacy is calculated as 1 - Risk Ratio, so an efficacy closer to 1 (or 100%) means that the vaccine reduces the risk of infection by a greater proportion. You can read more about vaccine efficacy on the CDC website here.\nRemember that ratios are multiplicative, not additive, so we can intepret 95% vaccine efficacy (the equivalent to 100%-95% = 5% risk ratio) as meaning that the risk for COVID in the vaccine group is 0.05 (5%) times the risk in the control group."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#a-simple-model",
    "href": "posts/vaccine_modelling/VaccineModelling.html#a-simple-model",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "A Simple Model",
    "text": "A Simple Model\nTo assess the potential effects of different vaccine rollouts, we will create a model of the COVID-19 pandemic in the United States. Our first step will be to develop a simple framework using principles from epidemiology before adding more complex features. For this simple model, we divide the population of the United States into four groups: susceptible (S), infected (I), recovered and immune (R), and deceased (D). At a specific point in time, every individual should fall into one and only one of these categories.\nWith these categories established, our next job is to determine a way to describe the flow of individuals from group to group. See Diagram 1 below:\n\n\n\n\n\n\n\n\nWe are interested in how the flow of individuals occurs over time, so we will measure it as the rate at which people exit/enter a group per day. Below we explore each arrow on the diagram above:\n\nS → I: The rate at which susceptible individuals become infected. This value intuitively depends on the rate of contact between susceptible and infected individuals as well as the probability that the disease would be transmitted given a contact occurs. Here we introduce our first parameter, \\(\\beta\\), which captures the rate of transmission. We can calculate \\(\\beta\\) using \\(R_0\\), the more intuitive “basic reproductive rate” of a disease, \\(\\gamma\\), the recovery rate (which is calculated as as 1/length of infectious period), and \\(N\\), the population size, because:\n\n\\[\\begin{align*}\n\\beta = \\frac{R_0 \\gamma}{N}\n\\end{align*}\\]\n       Thus, S → I is described by \\(\\beta S I\\) where \\(S\\) and \\(I\\) are the number\n       of individuals in groups S and I.\n\nI → D: The rate at which infected individuals die. This depends on our second parameter, \\(\\gamma\\), and a third parameter, \\(\\mu\\), the death rate. As the inverse of the infectious period, \\(\\gamma\\) captures the average number of infected individuals that stop being infectious each day (i.e. if the infectious period is 5 days, then 1/5 of infectious individuals stop being infectious each day). As the death rate, \\(\\mu\\) tells us what fraction of individuals leaving \\(I\\) are headed to \\(D\\) (what percent die), while the rest, or 1-\\(\\mu\\), recover and head to \\(R\\). Thus, I → D is described by \\(\\gamma I\\mu\\).\nI → R: The rate at which infected individuals recover. Using logic from I → D, above we have I → D is described by \\(\\gamma I(1-\\mu)\\). Note that the total rate at which individuals exit \\(I\\) is simply \\(\\gamma I\\) because every infected individual either dies or recovers.\nR → S: The rate at which recovered individuals lose immunity and become susceptible again. This value depends on a fourth paramter, \\(\\omega\\), the inverse of the period of immunity. It is the same idea as \\(\\gamma\\).\n\nWith these rates determined, we can now create a system of ordinary differential equations to describe the flow of people between groups. For each group, the change in size with respect to time (the derivative) is simply the sum of the rates with which people enter it (arrows entering the box) minus the rates with which people leave (arrows leaving the box). Thus, we have:\n\\[\\begin{align*}\n\\frac{dS}{dt} &= -\\beta S I + \\omega R \\\\\n\\frac{dI}{dt} &= \\beta S I - \\gamma I\\\\\n\\frac{dR}{dt} &= \\gamma I(1-\\mu) - \\omega R\\\\\n\\frac{dD}{dt} &= \\gamma I(\\mu)\n\\end{align*}\\]\nwhere the parameters \\(\\beta\\), \\(\\gamma\\), \\(\\omega\\), and \\(\\mu\\) are the transmission rate, recovery rate, loss of immunity rate, and death rate, respectively. If we set values for each of these parameters based on our knowledge of the COVID-19 pandemic and set initial sizes for each group, we can track the course of the disease by solving this system of ordinary differential equations for each day to model how the disease might progress."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#adding-long-term-immunity-vaccines",
    "href": "posts/vaccine_modelling/VaccineModelling.html#adding-long-term-immunity-vaccines",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "Adding Long-Term Immunity: Vaccines",
    "text": "Adding Long-Term Immunity: Vaccines\nNow that we have established the basic theoretical framework of the model, we can start to add complexities such as vaccines. Vaccinated individuals will come out of the susceptible group and enter a new group with different properties from the four we established before. See Diagram 2 below:\n\n\n\n\n\n\n\n\nThis model assumes that every vaccinated individual is protected completely from infection, but we know that this is not the case for COVID-19 vaccines in the real world. Accounting for this fact and supposing that individuals can receive one of two different vaccines, we have a new model detailed in Diagram 3.\n\n\n\n\n\n\n\n\nAssuming that the number of vaccines given per day, \\(\\nu_1\\) and \\(\\nu_2\\), and the rates of success, \\(\\varphi_1\\) and \\(\\varphi_2\\), for each vaccine are known, we now have the following system of ordinary differential equations:\n\\[\\begin{align*}\n\\frac{dS}{dt} &= -\\beta S I + \\omega R -  \\nu_1  -  \\nu_2 \\\\\n\\frac{dV_{1}}{dt} &= \\nu_1 - (1-\\varphi_1) \\beta V_1 I\\\\\n\\frac{dV_{2}}{dt} &= \\nu_2 - (1-\\varphi_2) \\beta V_2 I \\\\\n\\frac{dI}{dt} &= \\beta S I - \\gamma I + (1-\\varphi_1)\\beta V_{1} I + (1-\\varphi_2)\\beta V_{2} I \\\\ &= \\beta I[S + (1-\\varphi_1)V_{1} + (1-\\varphi_2)V_{2}] - \\gamma I\\\\\n\\frac{dR}{dt} &= \\gamma I(1-\\mu) - \\omega R\\\\\n\\frac{dD}{dt} &= \\gamma I(\\mu)\n\\end{align*}\\]\nThere are obviously a number of assumptions that this model is making for the sake of simplicity. The big ones are:\n\nEvery individual has the same \\(\\beta\\), that is the same probability of coming into contact with an infected individual and then contracting it.\nActually, all the parameters \\(\\beta\\), \\(\\gamma\\), \\(\\omega\\), \\(\\mu\\), \\(\\nu_1\\), \\(\\nu_2\\), \\(\\varphi_1\\), and \\(\\varphi_2\\) are constant throughout the population and over time.\nThe population is closed other than COVID deaths. No births or deaths from other causes are accounted for.\n\nWe should be okay with most of these assumptions for the sake of our simple model. Accounting for the ways in which behavioral changes, weather patterns, and government policies change the parameters would help the model better reflect the real life course of the virus, but we will leave that to the experts. With that said, there is one key factor that is currently being ignored - age.\nIt is well known that virus impacts different age groups in very different ways. In terms of our parameters, the death rate, \\(\\mu\\), varies greatly across age groups. On top of that, the vaccine rollout plans (impacting \\(\\nu_1\\) and \\(\\nu_2\\)) will also certainly account for differences in age. In the following section, I discuss how we can incorporate age classes into our model."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#adding-age-classes",
    "href": "posts/vaccine_modelling/VaccineModelling.html#adding-age-classes",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "Adding Age Classes",
    "text": "Adding Age Classes\nLet’s now suppose that our population is made up of distinct age classes where \\(N_i\\) is the number of individuals in age group \\(i\\). For our purposes, we will use the age classes (with their corresponding N and death rates) detailed below:\n\n\n\niAgePopulation (in Millions)Death Rate*10-419.580.0002625-920.190.00010310-1420.800.00010415-1921.060.00022520-2521.630.00040626-3023.500.00040731-3522.430.00135836-4021.730.00135941-4519.920.003461046-5020.400.003461151-5520.480.012671256-6021.870.012671361-6520.570.012671466-7017.460.048201571-7514.030.048201676-809.650.116361781-856.320.116361885+6.610.22083*Death Rate is calculated as overall deaths rate of population divided by overall incidence rate in population according to the CDC's ACIP report on 12/20/20. Population totals are for 2019 from Statistica.com.\n\n\nThe seemingly simple, however incorrect, approach would be to run our previously specified vaccine model on each age group individually and calculate the overall size of each group as the sum of its size in each age group. For example, \\(S = \\sum_{i=1}^{18} S_i\\). The problem with this approach is that it assumes that individuals only interact with, and therefore can only be infected by, people in the same age class. This is clearly not reflective of the real world.\nTo solve this issue, we need a contact matrix. A contact matrix describes the contacts between age group \\(i\\) and age group \\(j\\). As an example, let’s suppose that there are 900 students and 100 teachers in a school. Students make on average 40 contacts with other students and 10 contacts with teachers per day. Since the ratio of students to teachers is 9:1, students making 10 contacts with teachers on average means that teachers make on 10*9 = 90 contacts with students per day an average. Now also assume that the teachers only make contact with 5 other teachers per day on average. The contact matrix would be:\n\\[\n\\begin{bmatrix}\n40 & 10 \\\\\n90 & 5 \\\\\n\\end{bmatrix}\n\\]\nThese contact matrices have a few cool properties. You can read more about them here.\nBecause of the importance of the student-to-teacher ratio in the example above, contact matrices based on one demographic or social structure are are not generally compatible with other structures. Conveniently, a 2017 study by Kiesha Prem, Alex Cook, and Mark Jit estimated contact matrices for 152 countries, including the United States, using contact surveys and demographic data. We can download their contact matrix for the United States, multiply it by 0.2 to account for the reduced social mixing due to social distancing, and include it as a new parameter, C, in our model. You can view the code for the creation of C and the rest of this analysis at https://github.com/yangjasp/distill_site.\nFor our system of ordinary differential equations we now have:\n\\[\\begin{align*}\n\\frac{dS_i}{dt} &= -\\beta S_i C (I_i/N) + \\omega R_i - \\nu_{1i}  -  \\nu_{2i} \\\\\n\\frac{dV_{1i}}{dt} &=  \\nu_{1i} - (1-\\varphi_1) \\beta V_{1i} C (I_i/N)\\\\\n\\frac{dV_{2i}}{dt} &=  \\nu_{2i} - (1-\\varphi_2) \\beta V_{2i} C (I_i/N)\\\\\n\\frac{dI_i}{dt} &= \\beta S_i I_i - \\gamma I_i + (1-\\varphi_1)\\beta V_{1i} C (I_i/N) + (1-\\varphi_2)\\beta V_{2i} C (I_i/N) \\\\\n\\frac{dR_i}{dt} &= \\gamma I_i(1-\\mu_i) - \\omega R_i\\\\\n\\frac{dD_i}{dt} &= \\gamma I_i(\\mu_i)\n\\end{align*}\\]\nNote that this model assumes that the parameters \\(\\beta\\), \\(\\gamma\\), \\(\\omega\\), \\(\\varphi_1\\), and \\(\\varphi_2\\) are constant across all age classes, while the death rate, \\(\\mu_i\\), and the vaccination rates, \\(\\nu_{1i}\\) and \\(\\nu_{2i}\\), vary across classes."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#completing-the-final-model",
    "href": "posts/vaccine_modelling/VaccineModelling.html#completing-the-final-model",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "Completing the Final Model",
    "text": "Completing the Final Model\nIntroducing a contact matrix allows our model to more accurately capture the rate of transmission across age classes, but it does not account for the fact that asymptomatic carriers are much more likely to come into contact with susceptible individuals than symptomatic ones. With this fact in mind, we introduce one more parameter, \\(\\alpha_i\\), to represent the fraction of asymptomatic infections per age class. This addition should be an important one, as it will help our model better capture the reported role of young adults as viral spreaders. Similarly to the approach described in a 2012 paper by Tower and Feng, we can now split our infected (Is) classes into symptomatic (Is) and asymptomatic (Ia) class. We will also create a new contact matrix, Cs, which for our purposes will be a our old contact matrix, now called Ca, multiplied by some constant \\(k\\) &lt; 1 which represents the fraction of contacts that a symptomatic individual makes compared to an asymptomatic individual on average. This gives us a revised final system of ordinary differential equations:\n\\[\\begin{align*}\n\\frac{dS_i}{dt} &= -\\beta S_i [C^{a} (I^{a}_i/N_i) + C^{s} (I^{s}_i/N_i)] + \\omega R_i - \\nu_{1i}  -  \\nu_{2i} \\\\\n\\frac{dV_{1i}}{dt} &=  \\nu_{1i}  - \\beta (1-\\varphi_{1}) V_{1i} [C^{a} (I_i/N_i) + C^{s}(I^{s}_i/N_i)] \\\\\n\\frac{dV_{2i}}{dt} &=  \\nu_{2i}  - \\beta (1-\\varphi_{2}) V_{2i} [C^{a} (I_i/N_i) + C^{s}(I^{s}_i/N_i)]\\\\\n\\frac{dI^{a}_i}{dt} &=\n\\alpha_i\\Big[\\beta S_i [C^{a} (I^{a}_i/N_i) + C^{s} (I^{s}_i/N_i)] + \\\\ &\\phantom{=}\n\\beta (1-\\varphi_{1}) V_{1i} [C^{a} (I_i/N_i) + C^{s}(I^{s}_i/N_i)] +  \\\\ &\\phantom{=}  \\beta (1-\\varphi_{2}) V_{2i} [C^{a} (I_i/N_i) + C^{s}(I^{s}_i/N_i)]\\Big] -\n\\gamma I^{a}_i \\\\\n\\frac{dI^{s}_i}{dt} &= (1-\\alpha_i)\\Big[\\beta S_i [C^{a} (I^{a}_i/N_i) + C^{s} (I^{s}_i/N_i)] + \\\\ &\\phantom{=}\n\\beta (1-\\varphi_{1}) V_{1i} [C^{a} (I_i/N_i) + C^{s}(I^{s}_i/N_i)] +  \\\\ &\\phantom{=}  \\beta (1-\\varphi_{2}) V_{2i} [C^{a} (I_i/N_i) + C^{s}(I^{s}_i/N_i)]\\Big] -\n\\gamma I^{s}_i \\\\\n\\frac{dR_i}{dt} &= (1-\\mu_i)(\\gamma I^{a}_i + \\gamma I^{s}_i) - \\omega R_i\\\\\n\\frac{dD_i}{dt} &= \\mu_i(\\gamma I^{a}_i + \\gamma I^{s}_i)\n\\end{align*}\\]\nWhere \\(C^{s} = k C^{a}\\) in our case (it doesn’t have to in all cases, clearly, but we will use this for simplicity). This is our final model."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#running-the-model",
    "href": "posts/vaccine_modelling/VaccineModelling.html#running-the-model",
    "title": "Modeling COVID-19 and Vaccine Rollout Strategies",
    "section": "Running the Model",
    "text": "Running the Model\nWe can now use this model to answer our original question about the rollout of vaccines with different efficacies by adjusting the rates at which they are given in each age class, \\(\\nu_{1i}\\) and \\(\\nu_{2i}\\).\nSo how do we set \\(\\nu_{1i}\\) and \\(\\nu_{2i}\\)? According to a recent Bloomberg article, approximately 200,000 people per day are being vaccinated against COVID-19 on average. This number is pretty low, and some experts have said that this number needs to be much larger if the U.S. wants to reach its goals in 2021. Let’s say that the average number of vaccinations per day increases to 1 million in the new year. Since we defined \\(\\nu_{1i}\\) and \\(\\nu_{2i}\\) as the number of susceptible patients vaccinated per day, we can set a limit on the total vaccinations per day, \\(1,000,000 = \\sum_{i=1}^{18} \\nu_{1i}+\\nu_{2i}\\). Here, we assume that the limiting factor in doses per day is the administration of them, not the availability of the vaccines themselves. Right now, this appears to be a more than reasonable assumption.\nNote: for the models that follow, I will be using the following parameters:\n\n\n\n\n\n\n\nParameter\nValue\n\n\n\n\n\\(\\beta\\)\n0.05\n\n\n\\(\\gamma\\)\n1/7\n\n\n\\(\\omega\\)\n1/91\n\n\n\\(\\varphi_1\\)\n0.95\n\n\n\\(\\varphi_2\\)\n0.70\n\n\n\\(k\\)\n0.20\n\n\n\n\nScenario 1: Only One Vaccine Available"
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#conclusion",
    "href": "posts/vaccine_modelling/VaccineModelling.html#conclusion",
    "title": "Jasper Yang",
    "section": "Conclusion",
    "text": "Conclusion\nWhile the specific numbers predicted by our model will almost certainly vary from the real-life course of COVID-19 in the U.S. in 2021, the most important takeaway from this post is the vital role that vaccine efficacy and rollout strategies will play in determining the pandemic’s course. If and when multiple vaccines become available, policy makers must keep the importance of vaccine efficacy differences in mind as they seek to develop vaccine allocation approaches that maximize lives saved. If a new vaccine has a significantly lower efficacy (&lt; 85% according to our model) compared to the 95% efficacy of Pfizer and Moderna’s, it will be optimal to start administering it to low-risk individuals right away. If the efficacy is similar to 95% (&gt; 85% according to our model), the best strategy is to use it to ensure that the oldest individuals get vaccinated as soon as possible."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#model-extensions",
    "href": "posts/vaccine_modelling/VaccineModelling.html#model-extensions",
    "title": "Jasper Yang",
    "section": "Model Extensions",
    "text": "Model Extensions\nThe model framework set up in this post has the potential to become even more reflective of the real-life pandemic with some extra considerations. The true contact matrix and related transmission rate $\\beta$ are changing constantly as a result of developing societal perceptions of the virus, individual behaviors, and government policies. A time-dependent contact matrix and $\\beta_t$ would allow the model to reflect some of these dymanics. Another possible extension of the model could include more demographic classes that take into account other factors besides age such as job or location.\nAs a final point, this model is deterministic in that its projections are based on exact parameters without accounting for randomness. Despite this limitation, deterministic models are still used [widely](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6001967/) throughout epidemiology and have had some important applications. I am hoping to play around with a stochastic model that incorporates some of these other ideas in the future!\nAlso, let me know if there are any other scenarios I should explore. I am hoping to make a Shiny app that makes any scenario possible!"
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#appendix-notes-on-parameters-and-initial-conditions",
    "href": "posts/vaccine_modelling/VaccineModelling.html#appendix-notes-on-parameters-and-initial-conditions",
    "title": "Jasper Yang",
    "section": "Appendix: Notes on Parameters and Initial Conditions",
    "text": "Appendix: Notes on Parameters and Initial Conditions\n* The rate of death once infected with COVID in each of the following age groups is (taken as (deaths per 100,000)/(incidence per 100,000) from [CDC](https://www.cdc.gov/vaccines/acip/meetings/downloads/slides-2020-12/slides-12-20/02-COVID-Dooling.pdf) estimates. Assumes number of patients re-infected is minimal.): * The initial conditions for the model were estimated from [Statistica](https://www.statista.com/statistics/241488/population-of-the-us-by-sex-and-age/) population data and [New York Times COVID-19 data](https://www.nytimes.com/interactive/2020/us/coronavirus-us-cases.html) as of January 3, 2021. They were:\n```{r,echo = F, preview = F} pop_dat &lt;- data.frame(i = seq(1:18),Age = c(“0-4”,“5-9”,“10-14”,“15-19”,“20-25”,“26-30”,“31-35”,“36-40”,“41-45”,“46-50”,“51-55”,“56-60”,“61-65”,“66-70”,“71-75”,“76-80”,“81-85”,“85+”),population = c(19.58,10.32+9.87,10.62+10.18,10.75+10.31,11.06+10.57,12+11.5,11.35+11.08,10.88+10.85,9.91+10.01,10.09+10.31,10.09+10.39,10.64+11.23,9.86+10.71,8.2+9.26,6.5+7.53,4.32+5.33,2.68+3.64,2.38+4.23)) pop_dat$RateDeath &lt;- sprintf(“%.5f”,c(rates_df2[9,“death”], rates_df2[8,“death”], rates_df2[8,“death”], (3*rates_df2[8,“death”]+2*rates_df2[7,“death”])/5, rates_df2[7,“death”], rates_df2[7,“death”], rates_df2[6,“death”], rates_df2[6,“death”], rates_df2[5,“death”], rates_df2[5,“death”], rates_df2[4,“death”], rates_df2[4,“death”], rates_df2[4,“death”], rates_df2[3,“death”], rates_df2[3,“death”], rates_df2[2,“death”], rates_df2[2,“death”], rates_df2[1,“death”]))\npop_dat2 &lt;- data.frame(Age = pop_dat$Age) pop_dat2$N_0 &lt;- pop_dat$population pop_dat2$S_0 &lt;- sprintf(“%.2f”,pop_dat$population*0.975) pop_dat2$V2 &lt;- pop_dat2$V1 &lt;- rep(0, times = length(pop_dat$population)) pop_dat2$IA &lt;- sprintf(“%.2f”,pop_dat$population*0.0025) pop_dat2$IS &lt;- sprintf(“%.2f”,pop_dat$population*0.0025) pop_dat2$R &lt;- sprintf(“%.2f”,pop_dat$population*0.02) pop_dat2$D &lt;- rep(0, times = 18)\nnames(pop_dat2) &lt;- c(“Age”,“Population (in Millions)”,“S”,“V1”,“V2”,“IA”,“IS”,“R”,“D”)\ntable1 &lt;- flextable(pop_dat2) table1 &lt;- italic(table1, i = 1, italic = T, part = “header”) table1 &lt;- footnote(table1,value = as_paragraph(“All numbers are in millions”), ref_symbols = ” “) autofit(table1) ```\n* The models also assumes that: + The death and infection rates published in the CDC [ACIP Report](https://www.cdc.gov/vaccines/acip/meetings/downloads/slides-2020-12/slides-12-20/02-COVID-Dooling.pdf) on 12/20/20 are accurate and uniform within their defined age groups. + The vaccine is effective at preventing illness and transmission. + The contacts made by individuals are reduced by a constant multiplier as a result of social distancing guidelines. The nature and proportional allocation among age classes does not change. This is probably not true, but I am not aware of studies that have quantified the adjusted contact rates. + None of the parameters change over time. This is not true, as I assume/hope more extreme measures would be taken to slow the growth if it exploded. + Stochastic effects do not affect the course of the pandemic."
  },
  {
    "objectID": "posts/vaccine_modelling/VaccineModelling.html#references",
    "href": "posts/vaccine_modelling/VaccineModelling.html#references",
    "title": "Jasper Yang",
    "section": "References",
    "text": "References\n* Morris SE (2020). shinySIR: Interactive Plotting for Mathematical Models of Infectious Disease Spread. R package version 0.1.2, https://github.com/SineadMorris/shinySIR. * Prem K, Cook AR, Jit M (2017) Projecting social contact matrices in 152 countries using contact surveys and demographic data. * Towers, S. (2012, December 11). SIR Model with Age Classes. Retrieved January 02, 2021, from http://sherrytowers.com/2012/12/11/sir-model-with-age-classes/ * Towers, S., & Feng, Z. (2012). Social contact patterns and control strategies for influenza in the elderly. Mathematical biosciences, 240(2), 241-249. * *Computing Note:* All analysis was performed in R statistical software. The package deSolve was used to solve each system of differential equations. Plots were created with ggplot2. All code used in this analysis is available [here](https://github.com/yangjasp/distill_site/tree/main/_posts/2020-12-28-what-if-some-vaccines-are-more-effective-than-others)."
  },
  {
    "objectID": "posts/covid19_bayes/index.html",
    "href": "posts/covid19_bayes/index.html",
    "title": "COVID-19 Testing and Bayes’ Theorem",
    "section": "",
    "text": "In the nine months since COVID-19 diagnostic tests were first made available to the public in March, they have served valiantly as one of the world’s greatest tools for tracking the sweeping spread of the disease. Widespread testing has also enabled the return of professional sports, made the partial re-opening of many college campuses possible, and provided a sense of safety for small social gatherings.\nBut just how reliable are they? The answer to this question carries much more weight at the level of the individual in that a few inaccurate results out of 100 won’t change much in terms of health officials’ overall tracking of the disease, but it could be the difference between life and death of a loved one for the few that the error affects. Studies have suggested the true error rate is probably somewhere around this “few in a hundred” mark, but the accuracy can vary depending on other factors such as the type of test and time since exposure. For this reason, CDC guidelines clearly state that a negative test doesn’t clear someone from the possibility of being infected with COVID, but many people are still willing to act like it does. In some cases, this may be a reasonable risk to take, but a more thorough assessment of the risks requires an understanding of the importance of prior probability."
  },
  {
    "objectID": "posts/covid19_bayes/index.html#bayes-theorem-and-covid-testing",
    "href": "posts/covid19_bayes/index.html#bayes-theorem-and-covid-testing",
    "title": "COVID-19 Testing and Bayes’ Theorem",
    "section": "Bayes’ Theorem and COVID Testing",
    "text": "Bayes’ Theorem and COVID Testing\nReally, a COVID test should be treated as no more than a (quite strong) piece of evidence in a larger pool of information. If person A, who had a lengthy indoor dinner with a symptomatic friend, decides to get tested after experiencing symptoms and gets a positive result, they can be almost certain that they have COVID. If person B, who follows social distancing guidelines stricly, gets a precautionary test that comes back positive, there is still a fair chance that they have COVID, but their probability of being infected is much lower than person A’s. The only difference between these cases is the “other” evidence available in the larger pool, and it matters. Bayes’ Theorem helps us understand why and allows us to quantify the difference. In its simplest form, the theorem can be written as: \\[P(A|B)= \\frac{P(A)*P(B|A)}{P(B)}\\]\nWhere:\n\n\\(P(A|B)\\) is the updated, or posterior, probability of \\(A\\) given the evidence \\(B\\).\n\\(P(A)\\) is the prior probability of \\(A\\) before considering the evidence \\(B\\).\n\\(P(B|A)\\) is the conditional probability of the evidence \\(B\\) occurring supposing that the outcome \\(A\\) is in fact true.\n\\(P(B)\\) is the prior probability of the evidence \\(B\\) occurring before it actually occurred. This is the “universe” of our equation, which we are dividing to take only the portion where \\(A\\) is true.\n\nEssentially, Bayes’ theorem tells us how much a new piece of evidence alters the probability we assigned to the outcome before receiving the new evidence. This altered probability is called the posterior probablility, or \\(P(A|B)\\).\nApplying this theorem to our COVID testing case, we have \\[P(COVID^+|test\\:result)= \\frac{P(COVID^+)*P(test\\:result|COVID^+)}{P(test\\: result)}\\]\nWhile it may not look it, Bayes’ Theorem it is actually quite intuitive in this simple case. This becomes especially apparent when we consider the denominator, \\(P(test\\:result)\\), as the sum of two distinct parts. Because we don’t know for certain whether we have COVID, the test result could be false or true, so one part must account for the probability that the the result occurs and we have COVID and the other part for the probability that the result occurs and we don’t have COVID. Accordingly, we can break \\(P(test\\:result)\\) into the sum of \\(P(COVID^+)*P(test\\:result|COVID^+)\\) and \\(P(COVID^-)*P(test\\:result|COVID^-)\\), giving us a new application of Bayes’ Theorem to COVID:\n\\[\\scriptsize P(COVID^+|test\\:result)= \\frac{P(COVID^+)*P(test\\:result|COVID^+)}{P(COVID^+)*p(test\\:result|COVID^+)+P(COVID^-)*P(test\\:result|COVID^-)}\\]\nNow it is clear to see that this theorem simply represents the proportion of total scenarios where we receive a specific test result in which we also have COVID."
  },
  {
    "objectID": "posts/covid19_bayes/index.html#intepreting-covid-test-results-an-example",
    "href": "posts/covid19_bayes/index.html#intepreting-covid-test-results-an-example",
    "title": "COVID-19 Testing and Bayes’ Theorem",
    "section": "Intepreting COVID Test Results: An Example",
    "text": "Intepreting COVID Test Results: An Example\nScenario One: Let’s suppose that you work from home, strictly follow social distancing guidelines, and avoid leaving the house at all costs but live with one roommate who recently traveled out-of-state to visit family. Upon their return, they start to develop a fever and decide to get a COVID test which comes back positive. You isolate from them immediately and decide to get a Rapid Antigen test five days (to increase the chances of an accurate test by allowing the virus to incubate) later. It comes back negative. What is the probability that you have COVID?\nRecalling our previously outlined Bayesian approach to this question, we need to be able to estimate three probabilities:\n\n\\(P(COVID^+)\\): The prior probability of you having COVID prior to the test. Since you never leave the house, it is nearly certain that the only way you could have been infected with the virus was from your roommate. A recent study estimated the secondary transmission rate of COVID-19 within households to be 53%. This estimate is certainly not perfect, but it does’t have to be, so you reason that your prior probability of having COVID before receiving the test result is 0.53. Notice that because you either have COVID or you don’t, \\(P(COVID^-)\\) is 1-0.53 = 0.47.\n\\(P(test\\:result|COVID^+)\\): The probability that you would test negative given that you have COVID. This probability is called the “false negative rate” of the test. Digging into the research, you find a study that estimates a false negative rate of 20% for the specific test that you received (not bad for a rapid test given that the false negative rates of rapid antigen tests are thought to be anywhere from 10%-50% according to a Harvard Medical School Blog Article). Again, this estimate is probably not perfect, but it’s the best that you have.\n\\(P(test\\:result|COVID^-)\\): The probability that you would test negative given that you do not have COVID. This probability is called the “specificity” of the test. The same study that you used to find the false negative rate estimates the true negative rate to be 95%.\n\nPlugging these numbers into Bayes’ Theorem, you have:\n\\[\\small \\begin{split} P(COVID^+|test^-)  & = \\frac{P(COVID^+)*P(test^-|COVID^+)}{P(test^-)} \\\\ & =\n\\frac{P(COVID^+)*P(test^-|COVID^+)}{p(test^-|COVID^+)*P(COVID^+) + p(test^-|COVID^-)*P(COVID^-)} \\\\ & =\n\\frac{(0.53)(0.20)}{(0.20)(0.53) + (0.95)(1-0.53)} \\\\ & =\n0.192\n\\end{split} \\]\nWith this information, you determine that based on the evidence you have, there is still a 19.2% chance that you have COVID.\nScenario 2: Now suppose that your living situation is the same as scenario one, only you do not have a roommate. You can’t imagine that you have the virus given that you never leave the house, but you want to visit your parents for Thanksgiving, so you decide to get a PCR COVID test before leaving just to be safe. To your surprise, it comes back positive. What is the probability that you have COVID?\nFirst, we estimate the probabilities for Bayes’ Theorem:\n\n\\(P(COVID^+)\\): The prior probability of you having COVID prior to the test. Before getting the test, you thought that it was almost impossible for you to have the virus. If you do have it, you reason that you must have picked it up through a surface transmission on a grocery delivery. This type of transmission is known to be rare, and you usually wash your hands after touching any deliverires. You research to find an estimate that 3% of your county is currently infected with COVID and use that to assign your delivery driver a 3% chance of carrying COVID. You then find research that suggests the probability of you getting COVID from touching the same surface as an infected individual is 5%. Thus, you assign a prior probability of (0.05)(0.02) = 0.001, or 0.1%.\n\\(P(test\\:result|COVID^+)\\): In this scenario, this value is the probability that you would test positive given that you have COVID. This probability is called the “sensitivity” of the test. Digging into the research again, you find a study that estimates a false negative rate of 2% for the PCR COVID tests. If the false negative rate is 2%, that means that the true positive rate is 98%. If 2% of people who have COVID return a negative (falsely), the other 98% must positive (accurately).\n\\(P(test\\:result|COVID^-)\\): The probability that you would test positive given that you do not have COVID. This probability is called the “false positive rate” of the test. The same study that you used to find the test sensitivity estimates the true negative rate to be 95%. You find that an estimated false positive rate of 0.5% for PCR tests.\n\nPlugging these numbers into Bayes’ Theorm Formula, you have:\n\\[\\small \\begin{split} P(COVID^+|test^+)  & = \\frac{P(COVID^+)*P(test^+|COVID^+)}{P(test^+)} \\\\ & =\n\\frac{P(COVID^+)*P(test^+|COVID^+)}{p(test^+|COVID^+)*P(COVID^+) + p(test^+|COVID^-)*P(COVID^-)} \\\\ & =\n\\frac{(0.001)(0.98)}{(0.98)(0.001) + (0.005)(0.999)} \\\\ & =\n0.164\n\\end{split} \\]\nWith this information, you determine that based on the evidence you have, there is only a 16.4% chance that you have COVID."
  },
  {
    "objectID": "posts/covid19_bayes/index.html#another-interesting-bayesian-message",
    "href": "posts/covid19_bayes/index.html#another-interesting-bayesian-message",
    "title": "COVID-19 Testing and Bayes’ Theorem",
    "section": "Another Interesting Bayesian Message",
    "text": "Another Interesting Bayesian Message\nIn scenario 2 above, you conclude that the test result is more likely a false positive than a true positive despite the 0.5% false positive rate. Applying this to a larger scale, let’s suppose that a hospital implements a large-scale testing program where each of their 2,000 employees where each is tested weekly for COVID. They strike a deal with a PCR testing company that produces a test with a reported false-positive rate of 0.1% and a false-negative rate of 3% (note that we don’t have great estimates for the true rates for these tests). The COVID case rate in the area is low, and the previous COVID-monitoring program suggested that very few workers had been infected so far over the course of the pandemic. In other words, their COVID-prevention protocols seem to be working.\nAssuming that each worker takes similar precautions, we can assign each of the 2,000 the same underlying (prior) probability of being infected with COVID each week. Since their protocols have been effective, and other evidence suggests the employees are much more careful than the average person, we approximate that this probability is 0.12%. We now have all the pieces of Bayes’ Theorem, which we can use to estimate that the posterior probability of COVID infection for an employee that tests positive is only 0.371.\n\\[\\small \\begin{split} P(COVID^+|test^+)  & = \\frac{P(COVID^+)*P(test^+|COVID^+)}{P(test^+)} \\\\ & =\n\\frac{P(COVID^+)*P(test^+|COVID^+)}{p(test^+|COVID^+)*P(COVID^+) + p(test^+|COVID^-)*P(COVID^-)} \\\\ & =\n\\frac{(0.0012)(0.97)}{(0.97)(0.002) + (0.0012)(0.998)} \\\\ & =\n0.371\n\\end{split} \\]\nThis result means that almost 2/3 of employees that return positive tests each week do not actually have COVID. Since a positive test, regardless of the prior probability, likely means two weeks away from work for the potentially infected individual and their close contacts, this can have some harmful implications for the hospital’s operations. On the other hand, the increased chance of catching the two true positives may be worth the consequences.\nRegardless, this example illustrates the risk of over-testing a group of individuals that have a very low prior probability of being infected. If the underlying case rate is low, most positives are actually false, even if the false positive rate is small."
  },
  {
    "objectID": "posts/covid19_bayes/index.html#closing-remarks",
    "href": "posts/covid19_bayes/index.html#closing-remarks",
    "title": "COVID-19 Testing and Bayes’ Theorem",
    "section": "Closing Remarks",
    "text": "Closing Remarks\nIn reality, every individual either does or doesn’t have COVID. The probability that we are calculating is simply our best guess for the likelihood that someone has COVID based on the evidence that has been collected on the matter*. This probability can prove to be quite valuable when it is used to informing decision making around the disease. Remember, though, that the cost of spreading COVID is extremely high, so it best practice to stick to the side of caution. If there is even a small chance that you have COVID, quarantine and follow CDC guidelines!\n\n\n*If we wanted to be even more robust in our application of Bayes’ Theorem to COVID, we would use probability densities to capture the uncertainty at play in our determination of priors. Maybe in a future post."
  }
]